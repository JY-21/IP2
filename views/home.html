<!DOCTYPE html>
<html>
    <head>
        <title>ErRun: Home</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <link rel="stylesheet" href="styles.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    </head>
    <script src="script.js"></script>
    <body>
        <!--Side menu-->
        <aside class="side-menu">
            <div class="side-container">
                <ul>
                    <li><button onClick="newTask()">New Task</button></li>
                    <li><button onClick="deleteTask()">Delete Task</button></li>
                    <li><button onClick="editTask()">Edit Task</button></li>
                </ul>
            </div>
        </aside>

        <!--Top header-->
       <header class="top-header">
            <button onClick="goToProfile()">
                <img src="/profilepic.jpg" alt="Profile Picture" class="profile-pic">
            </button>
       </header>

        <main class="main-content">
            <h1>Current Tasks:</h1>
            <button id="newTaskBtn" class="new-task-btn">+ New Task</button>

            <!--Task list container-->
            <div id="taskList" class="task-list">

            </div>
        </main>

        <div id="taskModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                <span id="closeModal" class="close">&times;</span>
                <h2>Add Task</h2>
                </div>

                <div class="modal-body">
                <form id="taskForm" class="task-form-grid">
                    <input type="hidden" id="taskId" name="taskId">

                    <div>
                    <label for="taskTitle">Task Name:</label>
                    <input type="text" id="taskTitle" name="title" required>
                    </div>

                    <div>
                    <label for="taskCategory">Category:</label>
                    <input type="text" id="taskCategory" name="category" required>
                    </div>

                    <div class="full-width">
                    <label for="taskRemarks">Remarks (Optional):</label>
                    <textarea id="taskRemarks" name="remarks"></textarea>
                    </div>

                    <div>
                    <label for="taskOrigin">Point of Origin:</label>
                    <input type="text" id="taskOrigin" name="origin" required>
                    </div>

                    <input type="hidden" id="taskOriginLat" name="originLat">
                    <input type="hidden" id="taskOriginLon" name="originLon">
                    <div class="full-width">
                    <label>Locations:</label>
                    <div id="locationsContainer">
                        <div class="location-input">
                        <input type="text" name="taskLocations[]" placeholder="Enter Location" required>
                        <button type="button" class="remove-location">-</button>
                        </div>
                    </div>
                    <button type="button" id="addLocationBtn" class="small-btn">+ Add Location</button>
                    </div>

                    <div>
                        <label for="taskDeadline">Deadline:</label>
                        <input type="date" id="taskDeadline" name="deadline" required>
                    </div>

                </form>
                </div>

                <div class="modal-footer">
                <button type="submit" form="taskForm" class="save-btn">Save Task</button>
                </div>
            </div>
        </div>


        <!-- Delete Confirmation Modal -->
        <div id="deleteModal" class="modal">
            <div class="delete-modal-content">
                <div class="delete-modal-header">Confirm Delete</div>
                <div class="delete-modal-body">
                <p>Are you sure you want to delete this task?</p>
                </div>
                <div class="delete-modal-footer">
                <button id="cancelDeleteBtn" class="cancel-btn">Cancel</button>
                <button id="confirmDeleteBtn" class="delete-btn">Delete</button>
                </div>
            </div>
        </div>
        
        <!--map section-->
        <div class="map-section">
            <h2>Task Map View</h2>
            <div class="map-controls">
                <button id="showMapBtn" class="map-btn">Show Map</button>
                <button id="hidMapBtn" class="map-btn" style="display: none;">Hide Map</button>
            </div>
            <div id="taskMap" style="height: 400px; width: 100%; display: none; margin-top: 1rem;"></div>
            <!--route info will be dynamically inserted here-->
        </div>
    </body>
</html>